<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>All orders</title>
  <base href="../../static/" th:href="@{/}">
  <script src="js/header.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <link href="plugins/bootstrap-table/bootstrap-table.min.css" rel="stylesheet"/>
  <script src="js/footer.js"></script>
  <script src="plugins/bootstrap-table/bootstrap-table.min.js"></script>
</head>
<style>
  .color{
    background-color: #FFBF3D !important;
  }

  a.color:focus,a.color:hover,button.color:focus,button.color:hover{
    background-color:#DFB300!important
  }

  .Big{
    width: 90%;
    margin-left: 5%;
  }

  .contentsize{
    background-color: rgba(255,249,249,0.7);
    padding-bottom: 20px;
    flex: 0 0 80%;
    max-width: 80%;
  }

  .title{
    font-size: 45px;
    color: #FFBF3D;
    padding-left: 20px;
  }

</style>
<body th:style="'background-size: 100% 100%;background-image: url('+@{img/loginBack.jpg}+');background-repeat: no-repeat;background-position: center;background-attachment: fixed'" style="background-size: 100% 100%;background-image: url('../../static/img/loginBack.jpg');background-repeat: no-repeat;background-position: center;background-attachment: fixed">
<div id="header" class="fixed-top" >
  <nav class="navbar navbar-expand-lg navbar-light color" style="height-max: 100px" >
    <a class="navbar-brand color" href="#" style="height: 100%;padding: 0 0 ">
      <img src="img/logo.png" alt="logo"  style="height: 40px;">
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarScroll" aria-controls="navbarScroll" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarScroll">
      <ul class="navbar-nav mr-auto my-2 my-lg-0 navbar-nav-scroll" style="max-height: 100px;">
        <li class="nav-item active">
          <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Link</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-expanded="false">
            Link
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">Action</a></li>
            <li><a class="dropdown-item" href="#">Another action</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#">Something else here</a></li>
          </ul>
        </li>
        <li class="nav-item">
          <a class="nav-link disabled">Link</a>
        </li>
      </ul>
      <form class="d-flex">
        <input class="form-control mr-2" type="search" placeholder="Search" aria-label="Search">
        <button class="btn btn-outline-success" type="submit">Search</button>
      </form>
      <div style="">
        <ul class="navbar-nav mr-auto my-2 my-lg-0 navbar-nav-scroll" style="max-height: 100px;">
          <li class="nav-item dropdown" style="">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" aria-expanded="false">
              Username
            </a>
            <ul class="dropdown-menu" >
              <li><a class="dropdown-item" href="../templates/OrderDetail/All orders.html" th:href="@{/templates/Order/All orders.html}"">
                <i class="bi bi-list">&nbsp&nbsp</i>
                All Orders</a></li>
              <li><a class="dropdown-item" href="#">
                <i class="bi bi-person-lines-fill">&nbsp&nbsp</i>
                Profile</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="#">
                <i class="bi bi-box-arrow-right">&nbsp&nbsp</i>
                Log out</a></li>
            </ul>
          </li>
          <div class="brand" href="#" style="width: 40px;height: 40px;overflow: hidden;border-radius: 50%;float:right;box-shadow: 0 4px 8px rgba(0,0,0,.05);z-index: 1;">
            <img src="img/defaultAvatar.png" alt="Default avatar" style="width: 40px;height: 40px;" >
          </div>

        </ul>
      </div>


    </div>
  </nav>
</div>
<div style="height: 80px"></div>

<div class="Big">
  <p2 class="title"> <strong>All Orders
<!--    <a class="btn  btn-warning" href="#" role="button" style="float: right;margin-top: 20px; font-size: 20px"></a>-->
  </strong></p2>
  <hr class="dropdown-divider" style="border-top: 3px solid #FFBF3D; ">



  <div class="row" style="margin-top: 20px">
    <div class="col-4" style="flex: 0 0 20%; width: 20%;">
      <div class="list-group" id="list-tab" role="tablist">
        <a class="list-group-item list-group-item-action active" id="list-AllOrders-list" data-toggle="list" href="#list-AllOrders" role="tab" aria-controls="home">All orders</a>
        <a class="list-group-item list-group-item-action" id="list-InProgress-list" data-toggle="list" href="#list-InProgress" role="tab" aria-controls="profile">In progress</a>
        </div>
    </div>
    <div class="col-8 contentsize">
      <div class="tab-content " id="nav-tabContent" style="padding: 20px 20px">
        <div class="tab-pane fade show active" id="list-AllOrders" role="tabpanel" aria-labelledby="list-AllOrders-list">
          <div id="all"></div>
        </div>
        <div class="tab-pane fade" id="list-InProgress" role="tabpanel" aria-labelledby="list-InProgress-list"> <div id="inProgress"></div></div>
       </div>
    </div>
  </div>

  <button type="button" class="btn btn-warning" data-dismiss="modal" onclick="load1()"
          style="float: right; margin-top: 10px;margin-right: 10px">Check
  </button>

</div>





</body>

<script>
  $('#myList a').on('click', function (event) {
    event.preventDefault()
    $(this).tab('show')
  })
  $('a[data-toggle="list"]').on('shown.bs.tab', function (event) {
    event.target // newly activated tab
    event.relatedTarget // previous active tab
  })

  // result = {
  //   total: 3,
  //   rows: [{
  //     "id": 123,
  //     "username": "",
  //     "userAddressId": 123,
  //     "state": 1,
  //     "deliverymanId": 12,
  //     "createTime": 1594966733594,
  //     "pickupTime": 1594966733594,
  //     "img":[null,],
  //     "quantity":2,
  //     "totalPrice":123,
  //     "pickupTimeStr":"",
  //   },{
  //     "id": 123,
  //     "username": "",
  //     "userAddressId": 123,
  //     "state": 1,
  //     "deliverymanId": 12,
  //     "createTime": 1594966733594,
  //     "pickupTime": 1594966733594,
  //     "img":["","img/defaultAvatar.png"],
  //     "quantity":2,
  //     "totalPrice":123,
  //     "pickupTimeStr":"",
  //   },{
  //     "id": 123,
  //     "username": "",
  //     "userAddressId": 123,
  //     "state": 0,
  //     "deliverymanId": 12,
  //     "createTime": 1594966733594,
  //     "pickupTime": 1594966733594,
  //     "img":["",""],
  //     "quantity":2,
  //     "totalPrice":123,
  //     "pickupTimeStr":"",
  //   }]
  // }
  function load(){
      $.ajax({
          type: "get",
          url:"order/get",
          contentType:"application/json",
          success:function (result){
            load1(result)
          }
      })
  }

  function load1(result){
    let inProgress ="#inProgress";
    let all = "#all";
    for (let i=0;i<result.total;i++){
      if (result.rows[i].state===1) orders(result.rows[i],all);
      else orders(result.rows[i],inProgress);
    }
    alert("finish")

  }
  function orders(row,type){
    let imgnum = row.img.length;
    let img1="";
    let img2="";
    let img1Name="";
    let img2Name="";
    if ((row.img[0]===null||row.img[0]==="")&&(row.img[1]===null||row.img[1]==="")){
      $(`<div class="card order1" style="width: 90%;position: relative;margin-bottom: 20px">
                   <div class="dishPhoto card-img-top" style="width: 51%;padding: 10px 10px;height: 230px"></div>

                   <div class="card-body" style="position: absolute;left: 53%">
                   <h5 class="card-title">${row.id}</h5>
                   <p class="card-text"> Time: ${row.time}</p>
                   <p class="card-text"> Total Quantity: ${row.quantity}</p>
                   <p class="card-text"> Total Price: ${row.totalPrice}</p>
                   </div>
                   <a class="btn  btn-warning finishbtn" herf="" role="button" style="position: absolute;left: 83%;bottom: 5%; font-size: 17px;width:15%">Order Detail</a>
                   </div>`).insertBefore(type);
    }else if ((row.img[1]===null||row.img[1]==="")&&(row.img[0]!==null||row.img[0]!=="")) {
      img1 = row.img[0];
      img1Name = "Dish1";
      $(`<div class="card order1" style="width: 90%;position: relative;margin-bottom: 20px">
                   <div class="dishPhoto card-img-top" style="width: 51%;padding: 10px 10px;height: 230px">
                   <div class="dishPhoto1 float-left img-thumbnail" style="width: 42%; margin-right: 2%;height: 95%">
                       <img src=${img1} style="width: 90%;height: 80%" >
                       <p class="text-center" style="margin-top: 7px">${img1Name}</p>
                   </div>
                   </div>

                   <div class="card-body" style="position: absolute;left: 53%">
                   <h5 class="card-title">${row.id}</h5>
                   <p class="card-text"> Time: ${row.time}</p>
                   <p class="card-text"> Total Quantity: ${row.quantity}</p>
                   <p class="card-text"> Total Price: ${row.totalPrice}</p>
                   </div>
                   <a class="btn  btn-warning finishbtn" herf="" role="button" style="position: absolute;left: 83%;bottom: 5%; font-size: 17px;width:15%">Order Detail</a>
                   </div>`).insertBefore(type);

    }
    else if ((row.img[0]===null||row.img[0]==="")&&(row.img[1]!==null||row.img[1]!=="")) {
        img1 = row.img[1];
        img1Name = "Dish1";
        $(`<div class="card order1" style="width: 90%;position: relative;margin-bottom: 20px">
                   <div class="dishPhoto card-img-top" style="width: 51%;padding: 10px 10px;height: 230px">
                   <div class="dishPhoto1 float-left img-thumbnail" style="width: 42%; margin-right: 2%;height: 95%">
                       <img src=${img1} style="width: 90%;height: 80%" >
                       <p class="text-center" style="margin-top: 7px">${img1Name}</p>
                   </div>
                   </div>

                   <div class="card-body" style="position: absolute;left: 53%">
                   <h5 class="card-title">${row.id}</h5>
                   <p class="card-text"> Time: ${row.time}</p>
                   <p class="card-text"> Total Quantity: ${row.quantity}</p>
                   <p class="card-text"> Total Price: ${row.totalPrice}</p>
                   </div>
                   <a class="btn  btn-warning finishbtn" herf="" role="button" style="position: absolute;left: 83%;bottom: 5%; font-size: 17px;width:15%">Order Detail</a>
                   </div>`).insertBefore(type);
    }else {
      img1 =row.img[0];
      img1Name = "Dish1";
      img2 = row.img[1];
      img2Name = "Dish2";
      $(`<div class="card order1" style="width: 90%;position: relative;margin-bottom: 20px">
                   <div class="dishPhoto card-img-top" style="width: 51%;padding: 10px 10px;height: 250px">
                   <div class="dishPhoto1 float-left img-thumbnail" style="width: 42%; margin-right: 2%;height: 90%">
                       <img src=${img1} style="width: 90%;height: 80%" >
                       <p class="text-center" style="margin-top: 7px">${img1Name}</p>
                   </div>

                   <div class="dishPhoto2 float-left img-thumbnail" style="width: 42%;height: 90%">
                   <img src=${img2} style="width: 90%;height: 80%" >
                   <p class="text-center" style="margin-top: 7px">${img2Name}</p>
                   </div>
                   <div class="float-right" style="margin-top: 20%;margin-left: 2%">
                   <i class="bi bi-dot"></i><i class="bi bi-dot"></i><i class="bi bi-dot"></i>
                   </div>
                   </div>

                   <div class="card-body" style="position: absolute;left: 53%">
                   <h5 class="card-title">${row.id}</h5>
                   <p class="card-text"> Time: ${row.time}</p>
                   <p class="card-text"> Total Quantity: ${row.quantity}</p>
                   <p class="card-text"> Total Price: ${row.totalPrice}</p>
                   </div>
                   <a class="btn  btn-warning finishbtn" herf="" role="button" style="position: absolute;left: 83%;bottom: 5%; font-size: 17px;width:15%">Order Detail</a>
                   </div>`).insertBefore(type);
    }

  }

  document.onload = function (){
    setInterval(load,60000);
  }


</script>

</html>